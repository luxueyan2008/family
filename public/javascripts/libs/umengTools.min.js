(function(a){a.chartCache={};a.hashCache=[];window.uploadFileWait=false;a.fn.extend({renderChart:function(c){var d={chart:{defaultSeriesType:"area",animation:true,height:300},yAxis:{title:"",min:0},credits:{enabled:false},plotOptions:{area:{stacking:null,fillColor:{linearGradient:[0,0,0,300],stops:[[0,"rgb(160, 192, 193)"],[1,"rgba(255,255,255,0)"]]},marker:{symbol:"circle",fillColor:"#FFFFFF",lineWidth:2,lineColor:null}},series:{animation:true,events:{legendItemClick:function(j){var l=this.name+"_<dot>";
var k=this.chart.series;var e=k.length;for(var h=0;h<e;h++){if(k[h].name==l){k[h].visible?k[h].hide():k[h].show();}}}}}},tooltip:{enabled:true,formatter:function(){return""+this.x+"日"+this.series.name+" : "+this.y;
}},legend:{margin:25,enabled:true},subtitle:{}};var b=a.extend(true,{},d,c||{});return this.each(function(){b.chart.renderTo=a(this).attr("id");try{a.chartCache(a(this).attr("id")).destroy();
}catch(h){a.chartCache[a(this).attr("id")]=new Highcharts.Chart(b);}});},ajaxBlock:function(c){var d={message:"<img src='/imgs/xp/ajax-load.gif'/>",css:{width:"16px",border:"none",background:"none"},overlayCSS:{backgroundColor:"#FFF",opacity:0.8},baseZ:997};
var b=a.extend(true,{},d,c||{});return this.each(function(){a(this).block(b);});},timeFilterTab:function(b){var c={callback:null,selIndex:0,tabs:[{text:"今天",paramName:"period",paramVal:"today"},{text:"过去7天",paramName:"period",paramVal:"-7"},{text:"上周",paramName:"period",paramVal:"lastWeek"},{text:"上月",paramName:"period",paramVal:"lastMonth"},{text:"上季度",paramName:"period",paramVal:"lastQuarter"},{text:"自定义时间",paramName:"period",paramVal:"custom"}]};
b=a.extend(c,b||{});return this.each(function(){a(this).append(a("#time-filter-tmpl").tmpl(b,{getStatus:function(h){return h==this.data.selIndex?"sel":"";
}}));var e=a(this).find(".filter");var d=e.find("li:eq("+b.selIndex+")");e.find(".bg").animate({left:d.position().left+10,width:d.outerWidth()},500,"easeInOutCubic");
e.find("li").click(function(){a(this).addClass("sel").siblings("li").removeClass("sel");e.find(".bg").animate({left:a(this).position().left+10,width:a(this).outerWidth()},500,"easeInOutCubic");
if(a("a",this).attr("period")=="custom"){var h=a(this).closest(".filter").find(".custom").slideDown(300);h.find(".from").datepicker({defaultDate:"+1w",dateFormat:"yy-mm-dd",dayNamesMin:["日","一","二","三","四","五","六"],monthNames:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],numberOfMonths:2,onSelect:function(i){h.find(".to").datepicker("option","minDate",i);
}});h.find(".to").datepicker({defaultDate:"+1w",dateFormat:"yy-mm-dd",dayNamesMin:["日","一","二","三","四","五","六"],monthNames:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],numberOfMonths:2,onSelect:function(i){h.find(".from").datepicker("option","maxDate",i);
}});h.find(".btn_small_green").unbind("click").click(function(){a(this).closest(".filter").find(".custom").slideUp(300);if(b.callback){b.callback.call(this,b);
}});}else{a(this).closest(".filter").find(".custom").slideUp(300);if(b.callback){b.callback.call(this,b);}}});});},blockTab:function(b){var c={tabfors:a(".bodys"),callback:null,type:"normal",data:[]};
b=a.extend(c,b||{});b.tabfors.data("opt",b);return this.each(function(){a(this).find(".item").click(function(){if(b.type=="normal"){a(this).closest(".sub_head").find(".bg").animate({left:a(this).position().left+167,width:a(this).width()},500,"easeInOutCubic");
}a(this).addClass("sel").siblings(".item").removeClass("sel");a.tabSlideTo(a(this),b);if(b.callback){b.callback.apply(this,b.data);}});});},checkBox:function(b){var c={type:"single",group:"closed",callback:null};
b=a.extend(c,b||{});return this.each(function(){var e=this;function d(){var h=a(".sel",e).attr("group");a(".btn_checkbox",e).removeClass("disabled");h&&a(".btn_checkbox:not([group="+h+"])").addClass("disabled");
}d();a(".btn_checkbox",e).on("click",function(){if(!a(this).hasClass("disabled")){if(b.group=="closed"){if(b.type=="single"){a(this).addClass("sel").closest(".check_box").find(".btn_checkbox").not(this).removeClass("sel");
}else{if(b.type=="multi"){a(this).toggleClass("sel");}else{a(this).toggleClass("sel");if(a(this).hasClass("sel")){a(this).siblings(".btn_checkbox").removeClass("sel");
}}}}else{a(this).toggleClass("sel");d();}a(a(e).attr("linkfor")).val(a(".sel",e).map(function(){return a(this).attr("val");}).get().join(",")).trigger("change");
a(a(e).attr("groupfor")).val(a(".sel",e).attr("group")).trigger("change");b.callback&&b.callback.call(this,b);}});});},selectList:function(b){var c={defaultVal:"请选择",callback:null,val:"",platform:"",className:"",id:"",list:[]};
b=a.extend(c,b||{});return this.each(function(){var d=this;if(a(this).attr("inputid")){b.id=a(this).attr("inputid");}a(this).html(a("#select-custom").tmpl(b));
a(this).find(".select_input").off("click").on("click",function(){a(this).next().slideToggle(300);});a(this).find(".select_option li").off("click").on("click",function(){var e=a(a(d).find(".select_input").attr("linkfor"));
e.val(a(this).attr("val"));a(d).find(".select_input .select_value").text(a(this).text());a(this).closest(".select_option").slideUp(300);b.callback&&b.callback.call(this,b);
});});},addOperateBtns:function(b){var c={list:".ad_item",callback:null};b=a.extend(c,b||{});return this.each(function(){var d=a(a("#operate-btns").html());
d.find(".btn_small_black").on("click",function(){if(b.callback){b.callback.call(this,b);}});a(this).append(d);});},checkAll:function(b){return this.each(function(){a(this).on("click",function(){a(a(this).attr("selectAll")).prop("checked",a(this).prop("checked"));
});});},advanceSet:function(b){return this.each(function(){a(this).click(function(){a(this).toggleClass("expand");var c=a(a(this).attr("setfor"));if(c.is("tr,td")){if(c.is(":hidden")){c.show();
c.find("td>div").slideDown(300);}else{c.find("td>div").slideUp(300,function(){c.hide();});}}else{c.slideToggle(300);}if(b){b.call(this);}});});},setPrior:function(c){var b=[{value:"最高",statusBar:"prior_bar_red",val:"5"},{value:"高",statusBar:"prior_bar_yellow",val:"4"},{value:"中",statusBar:"prior_bar_green",val:"3"},{value:"低",statusBar:"prior_bar_blue",val:"2"},{value:"最低",statusBar:"prior_bar_pink",val:"1"}];
return this.each(function(){var d;a(this).on("click",function(l){l.stopPropagation();var h=this;var i={getStatus:function(){return this.data.val==a(h).attr("val")?"sel":"";
}};d=a('<ul class="prior_set dn"></ul>').append(a("#prior-set").tmpl(b,i));d.appendTo("body");var k=a(this).parent().offset().left+(a(this).parent().width()-d.width())/2;
var j=a(this).parent().offset().top;d.css({left:k,top:j}).slideDown(300);d.find("li").click(function(){a(this).addClass("sel").siblings("li").removeClass("sel");
if(c){c.call(h,{val:a(this).attr("val"),value:a(".prior_text",this).text()});}a(this).closest(".prior_set").slideUp(300,function(){a(this).remove();});
});});});},createAreaOpt:function(b){var c={callback:null,linkInput:a("#areas"),id:"",parentBody:a("body")};b=a.extend(c,b||{});(function(d){return this.each(function(){var h=this;
d.id="sub_body_"+a.getToken();d.parentBody.append(a("#sub-pop-area").tmpl(d));var e=a("#"+d.id);a(this).attr("area","#"+d.id);e.find("tr.tb_title").click(function(){a(this).nextUntil("tr.tb_title").find("input").prop("checked",a(this).find("input").prop("checked"));
});e.find("tr.area_list span.sub_title").click(function(){a(this).nextAll("input").prop("checked",a(this).find("input").prop("checked"));});e.find(".region_cancel").click(function(){e.animate({right:-e.outerWidth()-10+"px"},500);
});e.find(".region_ok").click(function(){var i=e.find("tr.area_list td>:checkbox").map(function(j,k){if(a(k).prop("checked")){return a(k).prev("label").text();
}}).get().join(",");if(i.split(",").length===37||i.length===0){a(h).find(".btn_checkbox.all").trigger("click");}else{d.linkInput.val(i);a(h).find(".btn_checkbox.special").attr("val",i);
}e.animate({right:-e.outerWidth()-10+"px"},500);});a(this).find(".btn_checkbox.all").click(function(){d.linkInput.val("all");});a(h).find(".btn_checkbox.special").click(function(){e.find(":checkbox").prop("checked",false);
if(d.linkInput.val()!=="all"){e.find("tr.area_list td>label").each(function(k,l){var j=d.linkInput.val();if(j.indexOf(a(l).text())>-1){a(l).next("input").prop("checked",true);
}});}else{e.find(":checkbox").prop("checked",true);}e.animate({right:"10px"},500);});});}).call(this,b);},pageNav:function(c,e){var d={ajaxUrl:"",totalPages:20,tmpl:null,viewCount:3,callback:null,pageFor:a(".table_body table tbody"),ajaxBlocker:a(".table_body"),current:1};
c=a.extend(d,c||{});function b(k,m){var n="",h,l;h=m-c.viewCount;l=m+c.viewCount;if(h<1){l=l-h+1;}if(l>k){h=h-l+k;}for(var j=0;j<k;j++){if(j===0||j==k-1||(j+1>=h&&j+1<=l)){n+='<a class="'+(j+1==m?"current":"")+'" p="'+(j+1)+'">'+(j+1)+"</a>";
}else{if(j==k-2){if(l<k-2){n+='<a class="dot" p="'+(j+1)+'">...</a>';}else{n+='<a  p="'+(j+1)+'">'+(j+1)+"</a>";}}else{if(j==1){if(h>3){n+='<a class="dot" p="'+(j+1)+'">...</a>';
}else{n+='<a  p="'+(j+1)+'">'+(j+1)+"</a>";}}}}}return n;}return this.each(function(){var i=a('<div class="pagin">');var h=b(c.totalPages,c.current);i.append(h);
i.find("a:not(.current)").click(function(){if(c.callback){c.callback.call(this,c,b);}});a(this).html(i);});},tipImageShow:function(){return this.each(function(){var d=a(a(this).attr("show")),h,e,b,c;
a(this).hover(function(j){var i=new Image();i.src=a(this).attr("href");if(i.width>350){i.height=i.height*350/i.width;i.width=350;}b=a(window).width();windowH=a(window).height();
e=a(this).offset().left+a(this).width();h=a(this).offset().top+a(this).height();if(a(this).attr("href").indexOf("baidu")<0){d.attr("src",a(this).attr("href")).width(i.width).height(i.height).show();
}else{d.attr("src",a(this).attr("href")+"&rnd="+Math.random()).width(i.width).height(i.height).show();}e-=b-a(this).offset().left+a(window).scrollLeft()<i.width?i.width:0;
h-=windowH-a(this).offset().top+a(window).scrollTop()<(i.height+20)?(i.height+25):0;d.css("left",e);d.css("top",h);},function(i){d.hide().attr("src","");
});});},umSlider:function(c){var b={init:function(d){var e={speed:10,step:1,auto:false,leftBtn:null,direction:"left",rightBtn:null,stop:false,pauseOnHover:false,pagin:null,slideIndex:0};
d=a.extend(e,d||{});return this.each(function(){var k=this;var j=a("li",this).outerHeight();var i=a("li",this).outerWidth();a(this).css({width:i+"px",height:j+"px",overflow:"hidden",position:"relative",zoom:1});
a("ul",this).css({width:i*a("li",this).length+"px",position:"absolute"});a("li",this).css({"float":"left"});if(d.auto){var l=function(){if(!d.stop){a(k).umSlider(d.direction=="left"?"slideLeft":"slideRight",d);
setTimeout(function(){l();},d.speed);}};setTimeout(function(){l();},d.speed);}else{d.leftBtn.click(function(){a(k).umSlider("slideRight",d);});d.rightBtn.click(function(){a(k).umSlider("slideLeft",d);
});}});},slideLeft:function(e){e=e||{step:1};var d=a("li",this).outerWidth();var h=a("li",this).length;if(e.slideIndex<h-1){++e.slideIndex;a("ul",this).animate({left:("-="+e.step*d)},300,function(){e.pagin.children(".sel").removeClass("sel");
e.pagin.children().eq(e.slideIndex).addClass("sel");});}else{e.stop=true;}},slideRight:function(e){e=e||{step:1};var d=a("li",this).outerWidth();if(e.slideIndex>0){--e.slideIndex;
a("ul",this).animate({left:("+="+e.step*d)},300,function(){e.pagin.children(".sel").removeClass("sel");e.pagin.children().eq(e.slideIndex).addClass("sel");
});}else{e.stop=true;}}};if(b[c]){return b[c].apply(this,Array.prototype.slice.call(arguments,1));}else{if(typeof c==="object"||!c){return b.init.apply(this,arguments);
}else{a.error("Method "+c+" does not exist on jQuery.tooltip");}}}});a.extend({getSearchParamVal:function(c,d){var b=new RegExp(d+"=([^&]*)&?","i").exec(c);
return b?b[1]:"";},renderNormalChartOpt:function(b,c,d){b.renderChart({chart:{renderTo:b.attr("id")},title:"",xAxis:{categories:d,labels:{align:"right",step:parseInt(d.length/7)}},series:c});
},getToken:function(){return Math.random().toString(16).substring(2);},tabSlideTo:function(b,d){var e=a(b.attr("tabfor"));var c=d.tabfors.children(".tab_show").index(e);
d.tabfors.children(".tab_show").removeClass("dn sel");e.addClass("sel");d.tabfors.animate({left:(-1000*c)+"px"},500,"easeInOutCubic",function(){a.bodyAutoFit();
});},bodyAutoFit:function(){var b=0;var c=a(".bodys .body.sel");var d=c.find(".sub_body.sel");if(d.length>0){b=d.outerHeight()+40;}else{b=c.outerHeight();
}a(".bodys").animate({height:b+"px"},300,"easeOutCubic");},cookie_get:function(b){var d=document.cookie.split("; ");g=d.length;f=[];for(var c=0;c<g;c++){f=d[c].split("=");
if(b===f[0]){return unescape(f[1]);}}return null;},cookie_set:function(e,d,b){var c=new Date();if(!b){c.setDate(c.getDate()+1);}else{c.setDate(c.getDate()-10);
}document.cookie=e+"="+escape(d)+"; expires="+c.toGMTString()+"; path=/";},popBox:function(c){var d={h_title:"test",body:"",animation:"slideFromTop",width:518,dialog_id:"dialog_"+a.getToken(),b_title:"",callback:null,closeHash:"",buttons:[{name:"ok",className:"",click:null}]};
a.removePopBox();c=a.extend(d,c||{});a("body").append(a("#pop-box").tmpl(c)).css({overflowY:"hidden"});var b=a("#"+c.dialog_id).find(".pop_dialog");b.attr("route",c.closeHash);
b.css({width:(c.width+20)+"px"});a.each(c.buttons,function(j,k){var h=a('<button id="btn_'+j+'" class="btn_mid_green '+k.className+'">'+k.name+"</button>");
if(typeof k.click=="function"){h.on("click",k.click).data("opt",c).appendTo(b.find(".pop_dialog_foot .buttons"));}});a("#"+c.dialog_id).fadeIn(300,function(){b.css({top:-b.height()+"px"});
var e;if(typeof c.callback=="function"){c.callback(c);}e=(a(window).height()-b.height())/2;if(c.animation=="fade"){b.css({top:(e<0?0:e)+"px"}).fadeIn(300);
}else{b.animate({top:(e<0?0:e)+"px"},300,function(){});}a("#"+c.dialog_id).find(".close").on("click",function(){a.closePopBox(a(this).closest(".pop_dialog"),c);
});});},removePopBox:function(){a("body .mark").remove();a("body").css({overflowY:"auto"});},closePopBox:function(c,b){location.hash=a.hashCache[a.hashCache.length-1];
function d(){a(this).closest(".mark").fadeOut(300).remove();a("body").css({overflowY:"auto"});}if(b&&b.animation=="fade"){c.fadeOut(300,function(){d.call(this);
});}else{c.animate({top:-c.height()+"px"},300,function(){d.call(this);});}},initHoverShow:function(b){a("dl.combine_val:not(.noshow)",b).hover(function(){a(this).stop().animate({top:"-45px"},500,"easeInOutCubic");
},function(){a(this).stop().animate({top:"0"},500,"easeInOutCubic");});a("td",b).hover(function(){a(".hover_show",this).stop().animate({right:"0"},500,"easeInOutCubic");
},function(){a(".hover_show",this).stop().animate({right:"-100px"},500,"easeInOutCubic");});},alert:function(d,b){var c={h_title:"提示:",body:"",animation:"fade",width:240,dialog_id:"dialog_"+a.getToken(),b_title:"",callback:null,buttons:[{name:"关闭","class":"",click:function(){a.closePopBox(a(this).closest(".pop_dialog"),{animation:"fade"});
return false;}}]};c.body='<div style="background:white;line-height:30px;padding:10px;">'+d+"</div>";b=a.extend(c,b||{});a.popBox(b);},confirm:function(d,b){var c={buttons:[{name:"确定","class":"",click:function(){var e=a(this).data("opt");
if(typeof e.sure=="function"){e.sure.call(this,e);}a.closePopBox(a(this).closest(".pop_dialog"),{animation:"fade"});return true;}},{name:"取消","class":"",click:function(){a.closePopBox(a(this).closest(".pop_dialog"),{animation:"fade"});
return false;}}]};b=a.extend(c,b||{});a.alert(d,b);},pieInit:function(b){if(window.PIE&&~~a.browser.version<9){b.find(".pie").each(function(){PIE.attach(this);
});}},upload:function(j,i,c,k,h,b){function e(){uploadFileWait=true;a(h).removeAttr("novalidate");var l=a(h).attr("action");a(h+"_uploadType").val(i);a(h+"_fileObject").val(j.id);
a(h+"_feedback").val(c);a(h+"_callback").val(k);a(h).attr("target","uploadFrame");a(h).attr("action","/upload/uploadFile");a(h)[0].submit();a(h).attr("target","_self");
a(h).attr("action",l);}if(j){if(a.verify_file(a(j))){a(j).parent().find("#loadingStatus").remove();a(j).parent().after('<img id="loadingStatus" src="/imgs/xp/ajax-load.gif" width="20" height="20"/>');
if(b&&b!="-"){var d=b.split("x");a(h+"_width").val(d[0]);a(h+"_height").val(d[1]);}if(!uploadFileWait){e();}else{uploadFileHd=setInterval(function(){if(uploadFileWait){return false;
}else{e();clearInterval(uploadFileHd);}},200);}}else{}}},verify_file:function(j,c){var h=new RegExp(a(j).attr("rule"),"gi");if(!h.test(j.val())){if(!c){j.closest("td").next().html("<span class='err'>"+a(j).attr("title")+"</span>");
}j.focus();return false;}else{var b=false;if(j[0].files){b=(j[0].files[0].size/1024>parseInt(j.attr("filesize")));}else{try{var d=new ActiveXObject("Scripting.FileSystemObject");
b=(d.GetFile(j.val()).size/1024>parseInt(j.attr("filesize")));}catch(i){j.closest("td").next().html("<span class='err'>建议使用非ie内核浏览器</span>");}}if(b){if(!c){j.closest("td").next().html("<span class='err'>文件不得大于"+j.attr("filesize")+"K</span>");
j.focus();}return false;}else{j.closest("td").next().find(".err").remove();return true;}}}});})(jQuery);